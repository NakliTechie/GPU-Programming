// Mental Model 13.0

// ... Host code launches kernel for each bit ...

// ===================================
// Device (GPU) Code for one Radix Sort Pass
// ===================================
__global__ void my_radix_sort_pass_kernel(...) {
  // --- STAGE 1: LOCAL SORT ---
  // 1a. Load a chunk of global data into shared memory.
  __syncthreads();
  
  // 1b. Extract the sorting key (e.g., a single bit) for each element.
  __syncthreads();

  // 1c. Perform a LOCAL SCAN on the keys to find local sorted positions.
  // (This is a self-contained, fast, in-block operation).
  __syncthreads();
  
  // 1d. Reorder the data within shared memory according to local sorted positions.
  __syncthreads();

  // --- STAGE 2: GLOBAL OFFSET CALCULATION ---
  // (This is the hard part, abstracted here)
  // 2a. Each block determines the size of its local buckets.
  // 2b. A GLOBAL SCAN is performed on these bucket sizes to find
  //     the starting address for each block's buckets in the final output array.
  //     This requires a separate kernel launch or a complex grid-wide sync.

  // --- STAGE 3: GLOBAL WRITE ---
  // 3. Each thread in the block performs a COALESCED write from its
  //    sorted shared memory bucket to the correct destination in global memory,
  //    offset by the result from the global scan.
}